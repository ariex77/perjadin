import{j as e,r as i,u as Q,a as X,t as r,H as Y}from"./app-D1xV2MNQ.js";import{C as T}from"./checkbox-DvR3f7U7.js";import{c as G}from"./date-DGrPaBmu.js";import{A as J}from"./arrow-up-down-DDMkyO0N.js";import{B as m}from"./button-CVReGMi9.js";import{D as Z,T as ee}from"./table-actions-BTAik_o0.js";import{I as se}from"./input-D287an5N.js";import{T as ae,a as te,b as v,c as le,d as re,e as _}from"./table-C9zv8eeL.js";import{u as ne}from"./navigation-Dl9NjHSU.js";import{u as ie,f as M,g as oe,a as ce,b as de,c as me}from"./index-CmcrdTLp.js";import{S as ue}from"./search-CRdp5riW.js";import{X as he,C as ge,A as pe}from"./app-layout-BMPghDTH.js";import{P as xe}from"./plus-CCMeCPrJ.js";import{C as fe}from"./chevron-left-f7zOjETo.js";import{P as je}from"./page-header-BNu3XJ9v.js";/* empty css            */import"./index-BCddxTNs.js";import"./index-D_4U4oV9.js";import"./index-B_9BfV9r.js";import"./check-DTKSkBb2.js";import"./format-Ca1hgyLe.js";import"./alert-dialog-CRMZjG_x.js";import"./eye-icMOcr8_.js";import"./users-DMjgkXJI.js";const we=u=>[{id:"select",header:({table:a})=>e.jsx(T,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:t=>a.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"}),cell:({row:a})=>e.jsx(T,{checked:a.getIsSelected(),onCheckedChange:t=>a.toggleSelected(!!t),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{id:"no",header:()=>e.jsx("div",{className:"text-center",children:"No"}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:u.from+a.index}),enableSorting:!1,enableHiding:!1},{accessorKey:"name",header:({column:a})=>e.jsxs("button",{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex items-center px-0",children:["Nama Unit",e.jsx(J,{className:"ml-2 h-3 w-3"})]})},{accessorKey:"code",header:"Kode",cell:({row:a})=>e.jsx("div",{children:a.original.code})},{accessorKey:"description",header:"Keterangan",cell:({row:a})=>e.jsx("div",{className:"max-w-sm line-clamp-5 text-wrap",children:a.original.description})},{accessorKey:"head_name",header:"Ketua TIM",cell:({row:a})=>e.jsx("div",{children:a.original.head_name??"-"})},{accessorKey:"created_at",header:"Tanggal Dibuat",cell:({row:a})=>e.jsx("div",{children:G(a.getValue("created_at"))})},{id:"actions",header:"Aksi",cell:()=>null,enableSorting:!1,enableHiding:!1}];function ke({columns:u,data:a,pagination:t,search:p=""}){const{navigateToCreate:x,navigateToEdit:P,navigateWithQuery:f}=ne(),[K,H]=i.useState([]),[I,A]=i.useState([]),[E,V]=i.useState({}),[$,j]=i.useState({}),[o,C]=i.useState(p),[B,c]=i.useState(!1),[N,h]=i.useState(null),[w,R]=i.useState("single"),{delete:F,post:U,processing:y,setData:k}=Q({ids:[]}),{props:z}=X(),g=z.flash;i.useEffect(()=>{g?.success&&r.success(g.success),g?.error&&r.error(g.error)},[g]);const d=ie({data:a,columns:u,onSortingChange:H,onColumnFiltersChange:A,getCoreRowModel:me(),getPaginationRowModel:de(),getSortedRowModel:ce(),getFilteredRowModel:oe(),onColumnVisibilityChange:V,onRowSelectionChange:j,state:{sorting:K,columnFilters:I,columnVisibility:E,rowSelection:$}}),q=()=>{const s=d.getSelectedRowModel().rows.map(n=>n.original.id);k("ids",s),R("bulk"),c(!0)},O=l=>{h(l),R("single"),c(!0)},L=()=>{w==="single"&&N?F(route("masters.work-units.destroy",N),{onBefore:()=>{r.loading("Sedang memproses...")},onSuccess:()=>{c(!1),j({}),h(null),d.resetRowSelection(),r.dismiss()},onError:()=>{c(!1),h(null),r.dismiss(),r.error("Terjadi kesalahan saat menghapus unit kerja.")}}):U(route("masters.work-units.bulk-delete"),{onBefore:()=>{r.loading("Sedang memproses...")},onSuccess:()=>{c(!1),j({}),h(null),d.resetRowSelection(),k("ids",[]),r.dismiss()},onError:()=>{c(!1),h(null),r.dismiss(),k("ids",[]),r.error("Terjadi kesalahan saat menghapus unit kerja.")}})},S=l=>{const s={};l>1&&(s.page=l),o&&(s.search=o),f("masters.work-units.index",s,{preserveState:!0,replace:!0})},W=l=>{const s=l.target.value;C(s);const n={};s&&(n.search=s),f("masters.work-units.index",n,{preserveState:!0,replace:!0})},D=()=>{C(""),f("masters.work-units.index",{},{preserveState:!0,replace:!0})},b=d.getSelectedRowModel().rows.length;return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(Z,{open:B,onOpenChange:c,onDelete:L,title:w==="single"?"Hapus unit kerja?":"Hapus unit kerja yang dipilih?",description:w==="single"?"Tindakan ini tidak dapat dibatalkan. unit kerja ini akan dihapus secara permanen dari sistem.":`Tindakan ini tidak dapat dibatalkan. ${b} unit kerja yang dipilih akan dihapus secara permanen dari sistem.`,disabled:y}),e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx(ue,{className:"absolute top-2.5 left-2 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Cari unit kerja...",value:o,onChange:W,className:"w-full pr-8 pl-8 md:w-[300px]"}),o&&e.jsx(m,{variant:"ghost",size:"sm",onClick:D,className:"absolute top-0 right-0 h-full px-3 hover:bg-transparent",children:e.jsx(he,{className:"h-4 w-4"})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(m,{onClick:()=>x("masters.work-units"),children:[e.jsx(xe,{className:"h-4 w-4"}),"Tambah"]}),b>0&&e.jsxs(m,{variant:"destructive",onClick:q,disabled:y,children:["Hapus (",b,")"]})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(ae,{children:[e.jsx(te,{children:d.getHeaderGroups().map(l=>e.jsx(v,{children:l.headers.map(s=>e.jsx(le,{className:s.id==="actions"?"w-[100px]":s.id==="no"?"w-[50px]":s.id==="select"?"w-[32px]":void 0,children:s.isPlaceholder?null:M(s.column.columnDef.header,s.getContext())},s.id))},l.id))}),e.jsx(re,{children:d.getRowModel().rows?.length?d.getRowModel().rows.map(l=>e.jsx(v,{"data-state":l.getIsSelected()&&"selected",children:l.getVisibleCells().map(s=>e.jsx(_,{className:s.column.id==="actions"?"w-[100px]":s.column.id==="no"?"w-[50px]":s.column.id==="select"?"w-[32px]":void 0,children:s.column.id==="actions"?e.jsx(ee,{onEdit:()=>P("masters.work-units",l.original.id),onDelete:()=>O(l.original.id)}):M(s.column.columnDef.cell,s.getContext())},s.id))},l.id)):e.jsx(v,{children:e.jsx(_,{colSpan:u.length,className:"h-24 text-center",children:o?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("p",{children:['Tidak ada unit kerja yang ditemukan untuk pencarian "',o,'"']}),e.jsx(m,{variant:"outline",size:"sm",onClick:D,children:"Hapus pencarian"})]}):"unit kerja tidak tersedia."})})})]})}),a.length>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:t?o?`Ditemukan ${t.total} hasil untuk "${o}"`:`Menampilkan ${t.from} - ${t.to} dari ${t.total} hasil`:`Menampilkan ${a.length} hasil`}),t&&t.last_page>1&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",onClick:()=>S(t.current_page-1),disabled:t.current_page===1,children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:Math.min(5,t.last_page)},(l,s)=>{const n=s+1;return t.last_page<=5?e.jsx(m,{variant:t.current_page===n?"default":"outline",size:"sm",onClick:()=>S(n),className:"h-8 w-8 p-0",children:n},n):null}),t.last_page>5&&e.jsxs("span",{className:"px-2 text-sm text-muted-foreground",children:["Page ",t.current_page," of ",t.last_page]})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>S(t.current_page+1),disabled:t.current_page===t.last_page,children:e.jsx(ge,{className:"h-4 w-4"})})]})]})]})}const Se=[{title:"Dasbor",href:"/dashboard"},{title:"Kelola Unit Kerja",href:"/masters/work-units"}];function Le({workUnits:u,search:a}){const{data:t,meta:p}=u,x=we(p);return e.jsxs(pe,{breadcrumbs:Se,children:[e.jsx(Y,{title:"Kelola Unit Kerja"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(je,{title:"Kelola Unit Kerja",subtitle:"Daftar unit kerja E-Perjadin"}),e.jsx(ke,{columns:x,data:t,pagination:p,search:a})]})]})}export{Le as default};
