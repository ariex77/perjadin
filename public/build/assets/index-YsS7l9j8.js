import{j as e,r as u,u as je,a as ve,t as j,H as Ne}from"./app-DcC59gM4.js";import{C as be,D as we,a as ye,b as ke,c as Ce,d as De,S as Se,e as Y,f as G,g as J,h as Q,i as Ae,X as L,T as Te,A as Pe,j as V,k as q,l as K}from"./app-layout-md0N9P8I.js";import{c as I,a as T,b as _e,B as w}from"./button-CpjRaYVo.js";import{C as Ee,a as $e,b as Me,c as Le,d as Re}from"./card-B1wzXt6A.js";import{E as Be,T as Ie,D as Ue}from"./table-actions-DxeP1VWF.js";import{I as Fe}from"./input-B_FIGcdk.js";import{P as He}from"./page-header-C_7k5sLc.js";import{C as Oe}from"./chevron-left-BJIDIYjM.js";import{S as Ve,a as qe,b as Ke,c as ze,d as Ye,e as E}from"./select-yq4R6Uel.js";import{S as X}from"./separator-DyCgdMap.js";import{f as A,a as Ge,t as z}from"./date-DGrPaBmu.js";import{g as W}from"./file-TGdxFJ4x.js";import{u as Je}from"./navigation-Dvw0Ywhi.js";import{F as Qe,U as R}from"./users-DLXe7dN4.js";import{M as Z}from"./map-pin-BhVwCCAx.js";import{C as B}from"./calendar-days-CweVvMYD.js";import{C as Xe}from"./circle-check-big-lT-oNzny.js";import{C as We}from"./circle-x-BPWZT8m0.js";import{D as Ze}from"./date-picker-Cs1nytN8.js";import{S as ea}from"./search-CFhtlakL.js";import{P as aa}from"./plus-BwJdn1uf.js";import{S as sa}from"./square-pen-BB9zgw_p.js";import{E as ta}from"./eye-B5TCxU7g.js";/* empty css            */import"./index-CcsY0bVV.js";import"./index-CAOgDV9q.js";import"./alert-dialog-CAdiPnCD.js";import"./index-D8OKb2YG.js";import"./chevron-down-JOi0Hr8o.js";import"./check-CoDZEjDS.js";import"./format-Ca1hgyLe.js";import"./label-DnZ7SDYy.js";import"./popover-QUURE3mk.js";import"./calendar-CvU2iXXj.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],ra=I("Briefcase",na);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],la=I("CircleCheck",ia);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],oa=I("RotateCcw",ca);function da({className:t,...s}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:T("mx-auto flex w-full justify-center",t),...s})}function ma({className:t,...s}){return e.jsx("ul",{"data-slot":"pagination-content",className:T("flex flex-row items-center gap-1",t),...s})}function $({...t}){return e.jsx("li",{"data-slot":"pagination-item",...t})}function M({className:t,isActive:s,size:i="icon",...f}){return e.jsx("a",{"aria-current":s?"page":void 0,"data-slot":"pagination-link","data-active":s,className:T(_e({variant:s?"outline":"ghost",size:i}),t),...f})}function ua({className:t,...s}){return e.jsxs("span",{"aria-hidden":!0,"data-slot":"pagination-ellipsis",className:T("flex size-9 items-center justify-center",t),...s,children:[e.jsx(Be,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]})}function xa({current:t,last:s,onChange:i,className:f,from:l,to:m,total:x,search:n}){const o=u.useMemo(()=>!s||s<=1?[1]:s<=7?Array.from({length:s},(c,p)=>p+1):t<=4?[1,2,3,4,5,"...",s]:t>=s-3?[1,"...",s-4,s-3,s-2,s-1,s]:[1,"...",t-1,t,t+1,"...",s],[t,s]),d=u.useMemo(()=>typeof x!="number"?null:n?`Ditemukan ${x} hasil untuk "${n}"`:typeof l=="number"&&typeof m=="number"?`Menampilkan ${l} - ${m} dari ${x} hasil`:null,[l,m,x,n]);return e.jsxs("div",{className:`flex items-center justify-between w-full ${f??""}`,children:[e.jsx("div",{className:"text-sm w-full",children:d}),e.jsx(da,{className:"w-full flex justify-end",children:e.jsxs(ma,{children:[e.jsx($,{children:e.jsx(M,{href:"#",size:"icon","aria-label":"Sebelumnya",className:t===1?"pointer-events-none opacity-50":void 0,onClick:c=>{c.preventDefault(),t>1&&i(t-1)},children:e.jsx(Oe,{className:"h-4 w-4"})})}),o.map((c,p)=>e.jsx($,{children:c==="..."?e.jsx(ua,{}):e.jsx(M,{href:"#",isActive:c===t,onClick:k=>{k.preventDefault(),i(Number(c))},children:c})},`${c}-${p}`)),e.jsx($,{children:e.jsx(M,{href:"#",size:"icon","aria-label":"Berikutnya",className:t===s?"pointer-events-none opacity-50":void 0,onClick:c=>{c.preventDefault(),t<s&&i(t+1)},children:e.jsx(be,{className:"h-4 w-4"})})})]})})]})}function pa(){const[t,s]=u.useState({isOpen:!1,title:"",description:"",actionLabel:"Hapus",cancelLabel:"Batal",onConfirm:()=>{}}),i=u.useCallback(n=>new Promise(o=>{const d=typeof n=="string"?{message:n}:n,{title:c="Konfirmasi",message:p,confirmText:k="Ya",cancelText:v="Batal",type:P="info"}=d,_=window.confirm(`${c}

${p}`);o(_)}),[]),f=u.useCallback(n=>new Promise(o=>{const d="Konfirmasi Hapus",c=n?`Apakah Anda yakin ingin menghapus ${n}? Tindakan ini tidak dapat dibatalkan.`:"Apakah Anda yakin ingin menghapus item ini? Tindakan ini tidak dapat dibatalkan.";s({isOpen:!0,title:d,description:c,actionLabel:"Hapus",cancelLabel:"Batal",onConfirm:()=>{s(p=>({...p,isOpen:!1})),o(!0)}}),s._resolve=o}),[]),l=u.useCallback(n=>{const o=n?`Apakah Anda yakin ingin memperbarui ${n}?`:"Apakah Anda yakin ingin memperbarui item ini?";return i({title:"Konfirmasi Perbarui",message:o,confirmText:"Perbarui",cancelText:"Batal",type:"warning"})},[i]),m=u.useCallback((n,o)=>{const d=o?`Apakah Anda yakin ingin ${n} ${o}?`:`Apakah Anda yakin ingin ${n} item ini?`;return i({title:`Konfirmasi ${n}`,message:d,confirmText:"Ya",cancelText:"Batal",type:"warning"})},[i]),x=u.useCallback(()=>{s(n=>({...n,isOpen:!1})),s._resolve&&(s._resolve(!1),s._resolve=null)},[]);return{confirm:i,confirmDelete:f,confirmUpdate:l,confirmAction:m,deleteState:t,handleDeleteCancel:x}}var y=(t=>(t.DRAFT="draft",t.SUBMITTED="submitted",t.REJECTED="rejected",t.APPROVED="approved",t))(y||{});function ha({isOpen:t,onClose:s,assignment:i}){if(!i)return null;const f=i.users||[];return e.jsx(we,{open:t,onOpenChange:s,children:e.jsxs(ye,{className:"max-w-2xl",children:[e.jsxs(ke,{children:[e.jsxs(Ce,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5"}),"Daftar Pegawai Penugasan"]}),e.jsx(De,{children:i.purpose})]}),e.jsx(Se,{className:"h-[70vh]",children:e.jsxs("div",{className:"space-y-4 pr-2",children:[e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:i.destination})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[A(i.start_date)," - ",A(i.end_date)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(R,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[f.length," Pegawai Ditugaskan"]})]})]}),e.jsx(X,{}),e.jsx("div",{className:"space-y-3",children:f.map(l=>{const m=i.reports?.find(n=>n.user_id===l.id),x=()=>!m||m.status===y.DRAFT?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Draft"})]}):m.status===y.SUBMITTED?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600",children:[e.jsx(Xe,{className:"h-4 w-4"}),e.jsx("span",{children:"Submitted"})]}):m.status===y.APPROVED?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(la,{className:"h-4 w-4"}),e.jsx("span",{children:"Approved"})]}):m.status===y.REJECTED?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(We,{className:"h-4 w-4"}),e.jsx("span",{children:"Rejected"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:"Unknown"})]});return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Y,{className:"h-10 w-10 border-2 border-background",children:[e.jsx(G,{src:W(l.photo)||void 0,alt:l.name}),e.jsx(J,{className:"text-sm font-medium",children:Q(l.name)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:l.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.work_unit||"Unit Kerja tidak tersedia"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:x()})]},l.id)})})]})}),e.jsx(Ae,{className:"flex justify-end gap-2",children:e.jsx(w,{variant:"outline",onClick:s,children:"Tutup"})})]})})}const fa=[{title:"Dasbor",href:"/dashboard"},{title:"Penugasan",href:"/assignments"}];function Wa({assignments:t,search:s="",date:i="",has_reports:f="",isAdminOrSuperadmin:l,isLeader:m,isVerifikator:x}){const{data:n,meta:o}=t,[d,c]=u.useState(s),[p,k]=u.useState(i?new Date(i):void 0),[v,P]=u.useState(f||"all"),[_,U]=u.useState(null),[ee,F]=u.useState(!1),{confirmDelete:ae,deleteState:N,handleDeleteCancel:se}=pa(),{navigateToCreate:te,navigateToEdit:ne,navigateToShow:re,navigateWithQuery:b}=Je(),{delete:ie}=je(),{props:H}=ve(),O=H.auth?.user?.id,C=H.flash;u.useEffect(()=>{C?.success&&j.success(C.success),C?.error&&j.error(C.error)},[C]);const D=()=>{const a={};return d&&(a.search=d),p&&(a.date=z(p)),v&&v!=="all"&&(a.has_reports=v),a},le=a=>{const r=a.target.value;c(r);const g=D();r?g.search=r:delete g.search,b("assignments.index",g,{preserveState:!0,replace:!0})},ce=()=>{c("");const a=D();delete a.search,b("assignments.index",a,{preserveState:!0,replace:!0})},oe=a=>{const r=D();a>1?r.page=a:delete r.page,b("assignments.index",r,{preserveState:!0,replace:!0})},de=a=>{k(a);const r=D();a?r.date=z(a):delete r.date,b("assignments.index",r,{preserveState:!0,replace:!0})},me=a=>{P(a);const r=D();a==="all"?delete r.has_reports:r.has_reports=a,b("assignments.index",r,{preserveState:!0,replace:!0})},ue=()=>{c(""),k(void 0),P("all"),b("assignments.index",{},{preserveState:!0,replace:!0})},xe=a=>{U(a),F(!0)},pe=()=>{F(!1),U(null)},he=a=>{ie(route("assignments.destroy",a),{onBefore:()=>{j.loading("Memproses...")},onSuccess:()=>{j.dismiss(),j.success("Penugasan berhasil dihapus.")},onError:r=>{j.dismiss(),j.error(r?.message||"Terjadi kesalahan saat menghapus penugasan.")}})},fe=a=>{const r=a.users||[];if(r.length===0)return!1;const g=a.reports||[],S=new Set(g.filter(h=>h.status===y.APPROVED).map(h=>h.user_id));return r.every(h=>S.has(h.id))},ge=(a=[])=>{const g=a.slice(0,5),S=a.length-5;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex -space-x-3",children:[g.map(h=>e.jsxs(V,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(Y,{className:"h-8 w-8 cursor-pointer border-2 border-background transition-all hover:z-10",children:[e.jsx(G,{src:W(h.photo)||void 0,alt:h.name}),e.jsx(J,{className:"text-xs",children:Q(h.name)})]})}),e.jsx(K,{className:"border bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:h.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:h.work_unit||"Unit Kerja tidak tersedia"})]})})]},h.id)),S>0&&e.jsxs(V,{children:[e.jsx(q,{asChild:!0,children:e.jsx("div",{className:"flex h-8 w-8 cursor-pointer items-center justify-center rounded-full border-2 border-background bg-muted",children:e.jsxs("span",{className:"text-xs font-medium text-muted-foreground",children:["+",S]})})}),e.jsx(K,{className:"border bg-background",children:e.jsxs("div",{className:"text-center text-xs text-foreground",children:[S," Pegawai Lainnya"]})})]})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.length," pegawai"]})]})};return e.jsx(Te,{children:e.jsxs(Pe,{breadcrumbs:fa,children:[e.jsx(Ne,{title:"Kelola Penugasan"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(He,{title:"Kelola Penugasan",subtitle:l?"Daftar semua penugasan dinas":m?"Daftar penugasan dinas anggota unit kerja Anda":x?"Daftar semua penugasan dinas":"Daftar penugasan dinas Anda"}),e.jsxs("div",{className:"flex w-full flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(ea,{className:"absolute top-2.5 left-2 h-4 w-4 text-muted-foreground"}),e.jsx(Fe,{placeholder:l||m||x?"Cari tujuan/nama pegawai...":"Cari tujuan...",value:d,onChange:le,className:"pr-8 pl-8"}),d&&e.jsx(w,{variant:"ghost",size:"sm",onClick:ce,className:"absolute top-0 right-0 h-full px-3 hover:bg-transparent",children:e.jsx(L,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-full",children:e.jsx(Ze,{value:p,onChange:de,placeholder:"Filter Tanggal..."})}),e.jsx("div",{className:"w-full",children:e.jsxs(Ve,{value:v,onValueChange:me,children:[e.jsx(qe,{children:e.jsx(Ke,{placeholder:"Status Laporan"})}),e.jsx(ze,{children:e.jsxs(Ye,{children:[e.jsx(E,{value:"all",children:"Semua Status"}),e.jsx(E,{value:"true",children:"Sudah Lapor"}),e.jsx(E,{value:"false",children:"Belum Lapor"})]})})]})}),(d||p||v!=="all")&&e.jsxs(w,{variant:"outline",onClick:ue,className:"flex w-min items-center gap-2",children:[e.jsx(oa,{className:"h-4 w-4"}),"Reset Filter"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(w,{onClick:()=>te("assignments"),children:[e.jsx(aa,{className:"h-4 w-4"}),"Tambah"]})})]}),e.jsx(X,{}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:n.length>0?n.map(a=>{const r=a?.creator?.id&&O?a.creator.id===O:!1;return e.jsxs(Ee,{className:`relative border-t-3 ${fe(a)?"border-t-green-500":"border-t-gray-400"}`,children:[e.jsx($e,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(B,{className:"h-3 w-3"}),Ge(a.created_at)]})}),r&&e.jsx(Ie,{onEdit:()=>ne("assignments",a.id),onDelete:async()=>{await ae("penugasan ini")&&he(a.id)}})]})}),e.jsxs(Me,{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(Le,{className:"line-clamp-3",children:a.purpose})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:a.destination})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(B,{className:"h-4 w-4"}),e.jsxs("span",{children:[A(a.start_date)," - ",A(a.end_date)]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(R,{className:"h-4 w-4"}),ge(a.users)]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(sa,{className:"h-4 w-4"}),a.creator.name]})]}),e.jsxs(Re,{className:"flex gap-2",children:[e.jsxs(w,{onClick:()=>xe(a),className:"w-1/3",variant:"outline",children:[e.jsx(R,{className:"h-4 w-4"}),"Info"]}),e.jsxs(w,{onClick:()=>re("assignments",a.id),className:"w-2/3",children:[e.jsx(ta,{className:"h-4 w-4"}),"Rincian"]})]})]},a.id)}):e.jsx("div",{className:"col-span-full",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 py-10 text-center",children:[e.jsx(ra,{className:"h-10 w-10 text-muted-foreground"}),e.jsx("p",{className:"font-medium",children:"Tidak ada data"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:d?l||x?`Tidak ada penugasan dengan tujuan atau nama pegawai "${d}"`:`Tidak ada penugasan dengan tujuan "${d}"`:l||x?"Belum ada penugasan yang dibuat.":"Penugasan Anda belum dibuat. Silahkan hubungi admin untuk membuat penugasan."})]})})}),n.length>0&&e.jsx(xa,{current:o.current_page,last:o.last_page,from:o.from,to:o.to,total:o.total,search:d,onChange:oe}),e.jsx(ha,{isOpen:ee,onClose:pe,assignment:_}),e.jsx(Ue,{open:N.isOpen,onOpenChange:se,onDelete:N.onConfirm,title:N.title,description:N.description,actionLabel:N.actionLabel,cancelLabel:N.cancelLabel})]})]})})}export{Wa as default};
