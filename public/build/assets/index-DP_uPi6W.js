import{j as e,r as n,u as ue,a as pe,t as d,b as I,H as he}from"./app-DcC59gM4.js";import{C as O}from"./checkbox-DRfxPaNd.js";import{c as ge}from"./date-DGrPaBmu.js";import{g as xe}from"./file-TGdxFJ4x.js";import{h as fe,X as C,n as je,A as we,o as Se}from"./app-layout-md0N9P8I.js";import{A as B}from"./arrow-up-down-DUccMzLh.js";import{B as c,a as be}from"./button-CpjRaYVo.js";import{D as ke,T as ve}from"./table-actions-DxeP1VWF.js";import{I as Ce}from"./input-B_FIGcdk.js";import{T as Ne,a as ye,b as U,c as _e,d as Pe,e as L}from"./table-BJorX1cb.js";import{u as Re}from"./navigation-Dvw0Ywhi.js";import{u as De,f as q,g as Te,a as Me,b as Ie,c as Ue}from"./index-DV1N9m57.js";import{P as Ae,a as He,b as Ke}from"./popover-QUURE3mk.js";import{C as Ve,a as $e,e as Ee,b as Fe,c as We,d as ze}from"./command-BSOzza0P.js";import{S as Oe}from"./search-CFhtlakL.js";import{C as Be}from"./check-CoDZEjDS.js";import{U as Le}from"./upload-XjPs63n1.js";import{P as qe}from"./plus-BwJdn1uf.js";import{P as Ge}from"./page-header-C_7k5sLc.js";import{A as Qe}from"./access-denied-BwvCYH-i.js";/* empty css            */import"./index-CcsY0bVV.js";import"./index-D8OKb2YG.js";import"./index-CAOgDV9q.js";import"./format-Ca1hgyLe.js";import"./users-DLXe7dN4.js";import"./alert-dialog-CAdiPnCD.js";import"./eye-B5TCxU7g.js";const Xe=g=>[{id:"select",header:({table:a})=>e.jsx(O,{checked:a.getIsAllPageRowsSelected()||a.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:l=>a.toggleAllPageRowsSelected(!!l),"aria-label":"Select all"}),cell:({row:a})=>e.jsx(O,{checked:a.getIsSelected(),onCheckedChange:l=>a.toggleSelected(!!l),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{id:"no",header:()=>e.jsx("div",{className:"text-center",children:"No"}),cell:({row:a})=>e.jsx("div",{className:"text-center",children:g.from+a.index}),enableSorting:!1,enableHiding:!1},{header:"Avatar",accessorKey:"photo",cell:({row:a})=>{const l=a.original.photo,m=xe(l);return m?e.jsx("img",{src:m,alt:a.original.name,width:40,height:40,className:"size-10 object-cover rounded-full"}):e.jsx("div",{className:"size-10 rounded-full bg-muted flex items-center justify-center text-xs font-medium",children:fe(a.original.name)})}},{accessorKey:"name",header:({column:a})=>e.jsxs("button",{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex items-center px-0",children:["Nama",e.jsx(B,{className:"ml-2 h-3 w-3"})]}),cell:({row:a})=>{const l=a.getValue("name"),m=a.original.username;return e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:l}),m&&e.jsxs("span",{className:"text-xs",children:["@",m]})]})})}},{accessorKey:"nip",header:"NIP",cell:({row:a})=>e.jsx("div",{children:a.getValue("nip")})},{accessorKey:"email",header:({column:a})=>e.jsxs("button",{onClick:()=>a.toggleSorting(a.getIsSorted()==="asc"),className:"flex items-center px-0",children:["Email",e.jsx(B,{className:"ml-2 h-3 w-3"})]}),cell:({row:a})=>a.original.email??"-"},{header:"Unit Kerja",accessorKey:"workUnit.name",cell:({row:a})=>a.original.workUnit?.name??"-"},{accessorKey:"created_at",header:"Tanggal dibuat",cell:({row:a})=>e.jsx("div",{children:ge(a.getValue("created_at"))})},{id:"actions",header:"Aksi",cell:({row:a})=>null,enableSorting:!1,enableHiding:!1}];function Ye({columns:g,data:a,pagination:l,search:m="",workUnits:u=[],workUnitId:S}){const{navigateToCreate:b,navigateWithQuery:x}=Re(),[G,Q]=n.useState([]),[X,Y]=n.useState([]),[J,Z]=n.useState({}),[ee,N]=n.useState({}),[i,y]=n.useState(m),[se,p]=n.useState(!1),[A,j]=n.useState(null),[_,H]=n.useState("single"),[r,P]=n.useState(S||""),[K,V]=n.useState(!1),[k,R]=n.useState(""),ae=n.useMemo(()=>k?u.filter(s=>s.label.toLowerCase().includes(k.toLowerCase())):u,[u,k]),v=n.useMemo(()=>{if(!r)return"Pilih Unit Kerja";const s=u.find(t=>String(t.value)===String(r));return s?s.label:"Pilih Unit Kerja"},[r,u]),$=n.useCallback((s={})=>{const t={},o=s.search!==void 0?s.search:i,f=s.work_unit_id!==void 0?s.work_unit_id:r,z=s.page!==void 0?s.page:1;o&&(t.search=o),f&&(t.work_unit_id=f),z>1&&(t.page=z),x("masters.employees.index",t,{preserveState:!0,replace:!0})},[i,r]),te=s=>{P(s),V(!1),R(""),$({work_unit_id:s,page:1})},le=()=>{P(""),$({work_unit_id:"",page:1})},E=()=>{y(""),P(""),R(""),x("masters.employees.index",{},{preserveState:!0,replace:!0})},{delete:re,post:ne,processing:F,setData:D}=ue({ids:[]}),{props:ie}=pe(),w=ie.flash;n.useEffect(()=>{w?.success&&d.success(w.success),w?.error&&d.error(w.error)},[w]);const h=De({data:a,columns:g,onSortingChange:Q,onColumnFiltersChange:Y,getCoreRowModel:Ue(),getPaginationRowModel:Ie(),getSortedRowModel:Me(),getFilteredRowModel:Te(),onColumnVisibilityChange:Z,onRowSelectionChange:N,state:{sorting:G,columnFilters:X,columnVisibility:J,rowSelection:ee}}),oe=()=>{const t=h.getSelectedRowModel().rows.map(o=>o.original.id);D("ids",t),H("bulk"),p(!0)},ce=s=>{j(s),H("single"),p(!0)},de=()=>{_==="single"&&A?re(route("masters.employees.destroy",{user:A}),{onBefore:()=>{d.loading("Sedang memproses...")},onSuccess:()=>{p(!1),N({}),j(null),h.resetRowSelection(),d.dismiss()},onError:()=>{p(!1),j(null),d.dismiss(),d.error("Terjadi kesalahan saat menghapus pegawai.")}}):ne(route("masters.employees.bulk-delete"),{onBefore:()=>{d.loading("Sedang memproses...")},onSuccess:()=>{p(!1),N({}),j(null),h.resetRowSelection(),D("ids",[]),d.dismiss()},onError:()=>{p(!1),j(null),d.dismiss(),D("ids",[]),d.error("Terjadi kesalahan saat menghapus pegawai.")}})},T=s=>{const t={};s>1&&(t.page=s),i&&(t.search=i),r&&(t.work_unit_id=r),x("masters.employees.index",t,{preserveState:!0,replace:!0})},me=n.useCallback(n.useMemo(()=>{let s;return t=>{const o=t.target.value;y(o),clearTimeout(s),s=setTimeout(()=>{const f={};o&&(f.search=o),r&&(f.work_unit_id=r),x("masters.employees.index",f,{preserveState:!0,replace:!0})},300)}},[r,x]),[r,x]),W=()=>{y("");const s={};r&&(s.work_unit_id=r),I.get(route("masters.employees.index"),s,{preserveState:!0,replace:!0})},M=h.getSelectedRowModel().rows.length;return e.jsxs("div",{className:"w-full space-y-4",children:[e.jsx(ke,{open:se,onOpenChange:p,onDelete:de,title:_==="single"?"Hapus pegawai?":"Hapus pegawai yang dipilih?",description:_==="single"?"Tindakan ini tidak dapat dibatalkan. Pegawai ini akan dihapus secara permanen dari sistem.":`Tindakan ini tidak dapat dibatalkan. ${M} pegawai yang dipilih akan dihapus secara permanen dari sistem.`,disabled:F}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-wrap w-full gap-2 sm:flex-nowrap",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full sm:w-2/3",children:[e.jsxs("div",{className:"relative w-full md:w-full",children:[e.jsx(Oe,{className:"absolute top-2.5 left-2 h-4 w-4 text-muted-foreground"}),e.jsx(Ce,{placeholder:"Cari pegawai...",value:i,onChange:me,className:"w-full pr-8 pl-8"}),i&&e.jsx(c,{variant:"ghost",size:"sm",onClick:W,className:"absolute top-0 right-0 h-full px-3 hover:bg-transparent",children:e.jsx(C,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"w-full flex-shrink-0",children:e.jsxs(Ae,{open:K,onOpenChange:V,children:[e.jsx(He,{asChild:!0,children:e.jsxs(c,{variant:"outline",role:"combobox","aria-expanded":K,className:"w-full flex items-center bg-transparent justify-between",children:[e.jsx("span",{className:"truncate text-left flex-1",children:v}),e.jsx(je,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Ke,{className:"w-sm p-0",align:"end",children:e.jsxs(Ve,{children:[e.jsx($e,{placeholder:"Cari unit kerja...",value:k,onValueChange:R}),e.jsxs(Ee,{children:[e.jsx(Fe,{children:"Unit kerja tidak ditemukan."}),e.jsx(We,{children:ae.map(s=>e.jsxs(ze,{value:s.label,onSelect:()=>te(String(s.value)),children:[e.jsx(Be,{className:be("mr-2 h-4 w-4",r===String(s.value)?"opacity-100":"opacity-0")}),s.label]},s.value))})]})]})})]})})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-1/3 sm:justify-end",children:[e.jsxs(c,{onClick:()=>b("masters.employees"),className:"w-full sm:w-auto",variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4"}),"Import"]}),e.jsxs(c,{onClick:()=>b("masters.employees"),className:"w-full sm:w-auto",children:[e.jsx(qe,{className:"h-4 w-4"}),"Tambah"]}),M>0&&e.jsxs(c,{variant:"destructive",onClick:oe,disabled:F,className:"w-full sm:w-auto",children:["Hapus (",M,")",e.jsx("span",{className:"sm:hidden",children:e.jsx(C,{className:"h-4 w-4"})})]})]})]}),(i||r)&&e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[i&&e.jsxs("div",{className:"flex items-center gap-1 bg-secondary text-secondary-foreground px-2 py-1 rounded-md text-sm",children:[e.jsxs("span",{children:["Cari: ",i]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:W,className:"h-4 w-4 p-0 hover:bg-transparent",children:e.jsx(C,{className:"h-3 w-3"})})]}),r&&e.jsxs("div",{className:"flex items-center gap-1 bg-secondary text-secondary-foreground px-2 py-1 rounded-md text-sm max-w-full",children:[e.jsxs("span",{className:"truncate",children:["Unit Kerja: ",v]}),e.jsx(c,{variant:"ghost",size:"sm",onClick:le,className:"h-4 w-4 p-0 hover:bg-transparent flex-shrink-0",children:e.jsx(C,{className:"h-3 w-3"})})]}),(i||r)&&e.jsx(c,{variant:"outline",onClick:E,className:"ml-2",children:"Reset Filter"})]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ne,{children:[e.jsx(ye,{children:h.getHeaderGroups().map(s=>e.jsx(U,{children:s.headers.map(t=>e.jsx(_e,{className:t.id==="actions"?"w-[100px]":t.id==="no"?"w-[50px]":t.id==="select"?"w-[32px]":void 0,children:t.isPlaceholder?null:q(t.column.columnDef.header,t.getContext())},t.id))},s.id))}),e.jsx(Pe,{children:h.getRowModel().rows?.length?h.getRowModel().rows.map(s=>e.jsx(U,{"data-state":s.getIsSelected()&&"selected",children:s.getVisibleCells().map(t=>e.jsx(L,{className:t.column.id==="actions"?"w-[100px]":t.column.id==="no"?"w-[50px]":t.column.id==="select"?"w-[32px]":void 0,children:t.column.id==="actions"?e.jsx(ve,{onShow:()=>I.get(route("masters.employees.show",{user:s.original.id})),onEdit:()=>I.get(route("masters.employees.edit",{user:s.original.id})),onDelete:()=>ce(s.original.id)}):q(t.column.columnDef.cell,t.getContext())},t.id))},s.id)):e.jsx(U,{children:e.jsx(L,{colSpan:g.length,className:"h-24 text-center",children:i||r?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs("p",{children:["Tidak ada pegawai yang ditemukan",i&&` untuk pencarian "${i}"`,r&&` di unit kerja "${v}"`]}),e.jsx(c,{variant:"outline",size:"sm",onClick:E,children:"Hapus semua filter"})]}):"Pegawai tidak tersedia."})})})]})}),a.length>0&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:l?i||r?`Ditemukan ${l.total} hasil${i?` untuk pencarian "${i}"`:""}${r?` di unit kerja "${v}"`:""}`:`Menampilkan ${l.from} - ${l.to} dari ${l.total} entri`:`Menampilkan ${a.length} entri`}),l&&l.last_page>1&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>T(l.current_page-1),disabled:l.current_page===1,children:"Sebelumnya"}),e.jsxs("div",{className:"flex items-center gap-1",children:[Array.from({length:Math.min(5,l.last_page)},(s,t)=>{const o=t+1;return l.last_page<=5?e.jsx(c,{variant:l.current_page===o?"default":"outline",size:"sm",onClick:()=>T(o),className:"h-8 w-8 p-0",children:o},o):null}),l.last_page>5&&e.jsxs("span",{className:"px-2 text-sm text-muted-foreground",children:["Halaman ",l.current_page," dari ",l.last_page]})]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>T(l.current_page+1),disabled:l.current_page===l.last_page,children:"Selanjutnya"})]})]})]})}const Je=[{title:"Dasbor",href:"/dashboard"},{title:"Kelola Pegawai",href:"/masters/employees"}];function _s({employees:g,search:a,workUnits:l,workUnitId:m}){const{data:u,meta:S}=g,b=Xe(S);return e.jsxs(we,{breadcrumbs:Je,children:[e.jsx(he,{title:"Kelola Pegawai"}),e.jsx(Se,{fallback:e.jsx(Qe,{}),children:e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(Ge,{title:"Kelola Pegawai",subtitle:"Daftar pegawai di E-Lapor Dinas"}),e.jsx(Ye,{columns:b,data:u,pagination:S,search:a,workUnits:l,workUnitId:m})]})})]})}export{_s as default};
