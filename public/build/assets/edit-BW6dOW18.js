import{r as P,a as k,u as C,j as e,H as E,b as I,t as S}from"./app-2aN5fFIm.js";import{I as l}from"./input-error-CkgwgHgP.js";import{B as h}from"./button-BItv0zFD.js";import{C as D}from"./combobox-ByCsIiY0.js";import{I as m}from"./input-UpUYnzU4.js";import{L as t}from"./label-BH8P7zAC.js";import{P as K}from"./page-header-BuPDwsye.js";import{A as L}from"./app-layout-DB0FO4Gy.js";import{I as H}from"./image-upload-NPQSB8Nm.js";import{S as x}from"./separator-DbH1_Z8_.js";import{M as R}from"./multiselect-CSDTn1Ha.js";import{T as A}from"./textarea-CciHhig-.js";import{E as F}from"./eye-off-BxNPkdBK.js";import{E as M}from"./eye-MQgWJon-.js";/* empty css            */import"./command-BR0mfrEc.js";import"./index--YxB8gKp.js";import"./search-CANJZ9BR.js";import"./popover-CFbJ8920.js";import"./index-CqrHCE41.js";import"./check-DKsR-Bc2.js";import"./users-DL2eMeY0.js";import"./card-CJLns8os.js";import"./input-error-BSEAQUU0.js";import"./upload-DdAPv1vP.js";import"./badge-eJlqMNco.js";const T=[{title:"Dashboard",href:"/dashboard"},{title:"Kelola Pegawai",href:"/masters/employees"},{title:"Edit",href:""}];function ce({user:n,workUnits:u,roles:g}){const[p,j]=P.useState(!1),{errors:o}=k().props,{data:s,setData:i,processing:c,reset:v}=C({name:n.name||"",level:n.level||"",nip:n.nip||"",number_phone:n.number_phone||"",email:n.email||"",username:n.username||"",work_unit_id:n.work_unit_id?n.work_unit_id.toString():"",photo:null,password:"",password_confirmation:"",roles:n.roles?.map(a=>a.name)||[],address:n.address?.address||"",city:n.address?.city||"",province:n.address?.province||""});function f(a){i("photo",a)}function w(a){a.preventDefault();const r=new FormData;r.append("_method","put"),r.append("name",s.name||""),r.append("nip",s.nip||""),r.append("number_phone",s.number_phone||""),r.append("email",s.email||""),r.append("username",s.username||""),r.append("level",s.level||""),r.append("work_unit_id",s.work_unit_id||""),r.append("address",s.address||""),r.append("city",s.city||""),r.append("province",s.province||""),s.roles.forEach(d=>{r.append("roles[]",d)}),s.password&&(r.append("password",s.password),r.append("password_confirmation",s.password_confirmation)),s.photo&&typeof s.photo!="string"&&r.append("photo",s.photo);const N=new Promise((d,_)=>{I.post(route("masters.employees.update",n.id),r,{onSuccess:()=>{d({name:"Pegawai"})},onError:y=>{_(y?.error||"Pegawai gagal diperbarui!")}})});S.promise(N,{loading:"Memproses..",success:d=>`${d.name} berhasil diperbarui.`,error:d=>String(d)})}const b=()=>{v()};return e.jsxs(L,{breadcrumbs:T,children:[e.jsx(E,{title:"Edit Pegawai"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(K,{title:"Edit pegawai",subtitle:"Perbarui data pegawai untuk E-Lapor Dinas"}),e.jsxs("form",{onSubmit:w,children:[e.jsx("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:e.jsxs("div",{className:"w-full space-y-4 md:w-2/3",children:[e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(H,{value:s.photo,onChange:f,placeholder:"Pilih atau ",error:o.photo,aspectRatio:"rounded",existingImage:n.photo})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Nama"}),e.jsx(m,{name:"name",value:s.name||"",onChange:a=>i("name",a.target.value),placeholder:"Nama Pegawai"}),e.jsx(l,{message:o.name,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"NIP"}),e.jsx(m,{type:"number",name:"nip",value:s.nip||"",onChange:a=>i("nip",a.target.value),placeholder:"NIP"}),e.jsx(l,{message:o.nip,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Username"}),e.jsx(m,{name:"username",value:s.username||"",onChange:a=>i("username",a.target.value),placeholder:"Username"}),e.jsx(l,{message:o.username,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Email"}),e.jsx(m,{name:"email",value:s.email||"",onChange:a=>i("email",a.target.value),placeholder:"Email"}),e.jsx(l,{message:o.email,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"No. HP"}),e.jsx(m,{type:"number",name:"number_phone",value:s.number_phone||"",onChange:a=>i("number_phone",a.target.value),placeholder:"No. HP"}),e.jsx(l,{message:o.number_phone,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Pangkat/Golongan"}),e.jsx(m,{name:"level",value:s.level||"",onChange:a=>i("level",a.target.value),placeholder:"Pangkat/Golongan"}),e.jsx(l,{message:o.level,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"work_unit_id",className:"text-sm font-medium",children:"Unit Kerja"}),e.jsx(D,{options:u.map(a=>({value:a.value,label:a.label})),value:s.work_unit_id||void 0,onValueChange:a=>i("work_unit_id",a),placeholder:"Pilih unit kerja",searchPlaceholder:"Cari unit kerja...",emptyText:"Tidak ada unit kerja ditemukan."}),e.jsx(l,{message:o.work_unit_id,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"roles",className:"text-sm font-medium",children:"Role"}),e.jsx(R,{value:s.roles,onChange:a=>i("roles",a),options:g.map(a=>({value:a.name||"",label:a.name==="employee"?"Pegawai":a.name==="leader"?"Pimpinan":a.name||""})),placeholder:"Pilih role",className:"w-full"}),e.jsx(l,{message:o.roles,className:"mt-1"}),s.roles.includes("leader")&&e.jsxs("div",{className:"text-sm text-amber-600 bg-amber-50 p-3 rounded-md border border-amber-200",children:[e.jsx("strong",{children:"Info:"})," Jika unit kerja sudah memiliki pimpinan, pimpinan baru akan menggantikan pimpinan lama. Pimpinan lama tetap dapat mengakses data historis review yang sudah dilakukan."]})]})]}),e.jsx(x,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Kota"}),e.jsx(m,{name:"city",value:s.city||"",onChange:a=>i("city",a.target.value),placeholder:"Kota"}),e.jsx(l,{message:o.city,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Provinsi"}),e.jsx(m,{name:"province",value:s.province||"",onChange:a=>i("province",a.target.value),placeholder:"Provinsi"}),e.jsx(l,{message:o.province,className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Alamat Lengkap"}),e.jsx(A,{name:"address",value:s.address,onChange:a=>i("address",a.target.value),placeholder:"Alamat Lengkap"}),e.jsx(l,{message:o.address,className:"mt-1"})]}),e.jsx(x,{}),e.jsxs("div",{className:"w-full space-y-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{type:p?"text":"password",name:"password",value:s.password||"",onChange:a=>i("password",a.target.value),placeholder:"Password"}),e.jsx("button",{type:"button",onClick:()=>j(!p),className:"absolute top-1/2 right-3 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:p?e.jsx(F,{size:18}):e.jsx(M,{size:18})})]}),e.jsx(l,{message:o.password,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Konfirmasi Password"}),e.jsx("div",{className:"relative",children:e.jsx(m,{type:p?"text":"password",name:"password_confirmation",value:s.password_confirmation||"",onChange:a=>i("password_confirmation",a.target.value),placeholder:"Konfirmasi Password"})}),e.jsx(l,{message:o.password_confirmation,className:"mt-1"})]})]})]})}),e.jsxs("div",{className:"flex max-w-3xl flex-col gap-3 pt-4 sm:flex-row",children:[e.jsx(h,{type:"button",variant:"outline",onClick:b,className:"flex-1 bg-transparent sm:flex-none",disabled:c,children:"Reset"}),e.jsx(h,{type:"submit",disabled:c,className:"flex-1 sm:flex-none",children:c?"Memproses...":"Simpan"})]})]})]})]})}export{ce as default};
