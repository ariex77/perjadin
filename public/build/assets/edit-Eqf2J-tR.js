import{r as y,a as C,u as E,j as e,H as I,b as S,t as K}from"./app-DcC59gM4.js";import{B as h}from"./button-CpjRaYVo.js";import{C as x}from"./combobox-Bbq5Jssc.js";import{I as L}from"./image-upload-DNTbj_mr.js";import{I as m}from"./input-B_FIGcdk.js";import{I as o}from"./input-error-C6nxwA3J.js";import{L as t}from"./label-DnZ7SDYy.js";import{M as D}from"./multiselect-sUPoWkYM.js";import{P as F}from"./page-header-C_7k5sLc.js";import{S as u}from"./separator-DyCgdMap.js";import{T}from"./textarea-CIYggA85.js";import{A as H}from"./app-layout-md0N9P8I.js";import{E as M}from"./eye-off-B6XtsINA.js";import{E as R}from"./eye-B5TCxU7g.js";/* empty css            */import"./command-BSOzza0P.js";import"./index-CAOgDV9q.js";import"./search-CFhtlakL.js";import"./popover-QUURE3mk.js";import"./index-CcsY0bVV.js";import"./check-CoDZEjDS.js";import"./card-B1wzXt6A.js";import"./input-error-CwjUQo6T.js";import"./upload-XjPs63n1.js";import"./badge-CyCmFY9U.js";import"./users-DLXe7dN4.js";const A=[{title:"Dashboard",href:"/dashboard"},{title:"Kelola Pegawai",href:"/masters/employees"},{title:"Edit",href:""}];function ce({user:n,workUnits:g,roles:j}){const[p,v]=y.useState(!1),{errors:i}=C().props,{data:s,setData:l,processing:c,reset:f}=E({name:n.name||"",level:n.level||"",nip:n.nip||"",number_phone:n.number_phone||"",email:n.email||"",gender:n.gender||"",username:n.username||"",work_unit_id:n.work_unit_id?n.work_unit_id.toString():"",photo:null,password:"",password_confirmation:"",roles:n.roles?.map(a=>a.name)||[],address:n.address?.address||"",city:n.address?.city||"",province:n.address?.province||""});function w(a){l("photo",a)}function b(a){a.preventDefault();const r=new FormData;r.append("_method","put"),r.append("name",s.name||""),r.append("nip",s.nip||""),r.append("number_phone",s.number_phone||""),r.append("email",s.email||""),r.append("username",s.username||""),r.append("level",s.level||""),r.append("work_unit_id",s.work_unit_id||""),r.append("address",s.address||""),r.append("city",s.city||""),r.append("province",s.province||""),s.roles.forEach(d=>{r.append("roles[]",d)}),s.password&&(r.append("password",s.password),r.append("password_confirmation",s.password_confirmation)),s.photo&&typeof s.photo!="string"&&r.append("photo",s.photo);const k=new Promise((d,_)=>{S.post(route("masters.employees.update",n.id),r,{onSuccess:()=>{d({name:"Pegawai"})},onError:P=>{_(P?.error||"Pegawai gagal diperbarui!")}})});K.promise(k,{loading:"Memproses..",success:d=>`${d.name} berhasil diperbarui.`,error:d=>String(d)})}const N=()=>{f()};return e.jsxs(H,{breadcrumbs:A,children:[e.jsx(I,{title:"Edit Pegawai"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:[e.jsx(F,{title:"Edit pegawai",subtitle:"Perbarui data pegawai untuk E-Lapor Dinas"}),e.jsxs("form",{onSubmit:b,children:[e.jsx("div",{className:"flex w-full flex-col gap-4 md:flex-row",children:e.jsxs("div",{className:"w-full space-y-4 md:w-2/3",children:[e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(L,{value:s.photo,onChange:w,placeholder:"Pilih atau ",error:i.photo,aspectRatio:"rounded",existingImage:n.photo})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Nama"}),e.jsx(m,{name:"name",value:s.name||"",onChange:a=>l("name",a.target.value),placeholder:"Nama Pegawai"}),e.jsx(o,{message:i.name,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"NIP"}),e.jsx(m,{type:"number",name:"nip",value:s.nip||"",onChange:a=>l("nip",a.target.value),placeholder:"NIP"}),e.jsx(o,{message:i.nip,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Username"}),e.jsx(m,{name:"username",value:s.username||"",onChange:a=>l("username",a.target.value),placeholder:"Username"}),e.jsx(o,{message:i.username,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Email"}),e.jsx(m,{name:"email",value:s.email||"",onChange:a=>l("email",a.target.value),placeholder:"Email"}),e.jsx(o,{message:i.email,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"No. HP"}),e.jsx(m,{type:"number",name:"number_phone",value:s.number_phone||"",onChange:a=>l("number_phone",a.target.value),placeholder:"No. HP"}),e.jsx(o,{message:i.number_phone,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Pangkat/Golongan"}),e.jsx(m,{name:"level",value:s.level||"",onChange:a=>l("level",a.target.value),placeholder:"Pangkat/Golongan"}),e.jsx(o,{message:i.level,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"gender",children:"Jenis Kelamin"}),e.jsx(x,{options:[{value:"Male",label:"Laki-laki"},{value:"Female",label:"Perempuan"}],value:s.gender,onValueChange:a=>l("gender",a),placeholder:"Pilih jenis kelamin",searchPlaceholder:"Cari jenis kelamin...",emptyText:"Tidak ada jenis kelamin ditemukan."}),e.jsx(o,{className:"mt-2",message:i.gender})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"work_unit_id",className:"text-sm font-medium",children:"Unit Kerja"}),e.jsx(x,{options:g.map(a=>({value:a.value,label:a.label})),value:s.work_unit_id||void 0,onValueChange:a=>l("work_unit_id",a),placeholder:"Pilih unit kerja",searchPlaceholder:"Cari unit kerja...",emptyText:"Tidak ada unit kerja ditemukan."}),e.jsx(o,{message:i.work_unit_id,className:"mt-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"roles",className:"text-sm font-medium",children:"Role"}),e.jsx(D,{value:s.roles,onChange:a=>l("roles",a),options:j.map(a=>({value:a.name||"",label:a.name==="employee"?"Pegawai":a.name==="leader"?"Pimpinan":a.name||""})),placeholder:"Pilih role",className:"w-full"}),e.jsx(o,{message:i.roles,className:"mt-1"}),s.roles.includes("leader")&&e.jsxs("div",{className:"rounded-md border border-amber-200 bg-amber-50 p-3 text-sm text-amber-600",children:[e.jsx("strong",{children:"Info:"})," Jika unit kerja sudah memiliki pimpinan, pimpinan baru akan menggantikan pimpinan lama. Pimpinan lama tetap dapat mengakses data historis review yang sudah dilakukan."]})]})]}),e.jsx(u,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Kota"}),e.jsx(m,{name:"city",value:s.city||"",onChange:a=>l("city",a.target.value),placeholder:"Kota"}),e.jsx(o,{message:i.city,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Provinsi"}),e.jsx(m,{name:"province",value:s.province||"",onChange:a=>l("province",a.target.value),placeholder:"Provinsi"}),e.jsx(o,{message:i.province,className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Alamat Lengkap"}),e.jsx(T,{name:"address",value:s.address,onChange:a=>l("address",a.target.value),placeholder:"Alamat Lengkap"}),e.jsx(o,{message:i.address,className:"mt-1"})]}),e.jsx(u,{}),e.jsxs("div",{className:"grid w-full grid-cols-2 gap-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{type:p?"text":"password",name:"password",value:s.password||"",onChange:a=>l("password",a.target.value),placeholder:"Password"}),e.jsx("button",{type:"button",onClick:()=>v(!p),className:"absolute top-1/2 right-3 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:p?e.jsx(M,{size:18}):e.jsx(R,{size:18})})]}),e.jsx(o,{message:i.password,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Konfirmasi Password"}),e.jsx("div",{className:"relative",children:e.jsx(m,{type:p?"text":"password",name:"password_confirmation",value:s.password_confirmation||"",onChange:a=>l("password_confirmation",a.target.value),placeholder:"Konfirmasi Password"})}),e.jsx(o,{message:i.password_confirmation,className:"mt-1"})]})]})]})}),e.jsxs("div",{className:"flex max-w-3xl flex-col gap-3 pt-4 sm:flex-row",children:[e.jsx(h,{type:"button",variant:"outline",onClick:N,className:"flex-1 bg-transparent sm:flex-none",disabled:c,children:"Reset"}),e.jsx(h,{type:"submit",disabled:c,className:"flex-1 sm:flex-none",children:c?"Memproses...":"Simpan"})]})]})]})]})}export{ce as default};
